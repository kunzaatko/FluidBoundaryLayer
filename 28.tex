\documentclass{article}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{physics}
\usepackage[left=1cm,right=1cm,top=1cm,bottom=2cm]{geometry}
\newtheorem{example}{Příklad}
\begin{document}
\setcounter{example}{27}
\begin{example}
	Řešte metodou střelby Blasiovu rovnici mezní vrstvy
	\begin{gather*}
		y''' + y y'' + \lambda \left( 1 - y'^{2} \right)  = 0,
		\qq{kde } x \in (0,10) \qcomma \lambda \in \langle 0, 0.5 \rangle \\
		y(0) = y'(0) = 0 \qcomma y'(10) = 1
	\end{gather*}
	\smallskip
	\hrule
	\medskip
	Nejprve musíme diferenciální rovnici třetího řádu rozložit na tři obyčejné diferenciální rovnice prvního řádu. To provedeme substitucemi:
	\begin{equation}
		\label{substituce}
		y = z^{(0)}(x) \qcomma
		y' = z^{(1)}(x) = \dv{z^{(0)}}{x} \qcomma
		y'' = z^{(2)}(x) = \dv{z^{(1)}}{x} \qcomma
		y''' = z^{(3)}(x) = \dv{z^{(2)}}{x}.
	\end{equation}
	Dosazením \ref{substituce} do původní rovnice pak získáváme soustavu differenciálních rovnic prvního řádu pro funkce $z^{(0)}, z^{(1)}, z^{(2)}$:
	\begin{equation}
		\begin{aligned}
			z^{(0)}(x) & = y                                                                                   \\
			z^{(1)}(x) & = \dv{z^{(0)}}{x}                                                                     \\
			z^{(2)}(x) & = \dv{z^{(1)}}{x}                                                                     \\
			z^{(3)}(x) & = \dv{z^{(2)}}{x}(x) & = -\lambda \left( 1 - {z^{(1)}}^{2} \right)  - z^{(2)}z^{(0)}.
		\end{aligned}
	\end{equation}
	Počáteční podmínky se převedou na $z^{(0)}(0) = 0$ a $z^{(1)}(0) = 0$ a koncová podmínka na $z^{(1)}(10) = 1$.

	\bigskip

	Tuto soustavu budeme vnímat jako vektorovou funkci od $x$, a definujeme $\vec{f}(x)$ jako její $\grad_x$ konkrétně
	\begin{equation}
		\vec{Z}(x) =
		\begin{pmatrix}
			z^{(0)}(x) \\
			z^{(1)}(x) \\
			z^{(2)}(x) \\
		\end{pmatrix} \qcomma
		\vec{f}\left(x,\vec{Z}\right) =
		\begin{pmatrix}
			\dv{z^{(0)}}{x}\eval_{x,\vec{Z}} \\
			\dv{z^{(1)}}{x}\eval_{x,\vec{Z}} \\
			\dv{z^{(2)}}{x}\eval_{x,\vec{Z}} \\
		\end{pmatrix}  =
		\begin{pmatrix}
			z^{(1)}(x,\vec{Z}) \\
			z^{(2)}(x,\vec{Z}) \\
			z^{(3)}(x,\vec{Z}) \\
		\end{pmatrix} =
		\begin{pmatrix}
			z^{(1)} \\
			z^{(2)} \\
			-\lambda \left( 1 - {z^{(1)}}^{2} \right)  - z^{(2)}z^{(0)}
		\end{pmatrix}.
	\end{equation}
	Numerické řešení budeme provádět jednosměrnou metodou střelby z bodu $x_{0} = \vec{0}$ a řešení diferenciálních rovnic s pokusnými počátečními podmínkami Rundge-Kutta metodou čtvrtého řádu tedy:
	\begin{equation}
		\begin{aligned}
			\vec{k}_{1} & = h \cdot \vec{f}\left(  x_{n}, \vec{Z}(x_{n}) \right)                                       \\
			\vec{k}_{2} & = h \cdot \vec{f}\left(  x_{n} + \frac{h}{2}, \vec{Z}(x_{n}) + \frac{\vec{k}_{1}}{2} \right) \\
			\vec{k}_{3} & = h \cdot \vec{f}\left( x_{n} + \frac{h}{2}, \vec{Z}(x_{n}) + \frac{\vec{k}_{2}}{2}  \right) \\
			\vec{k}_{4} & = h \cdot \vec{f}\left( x_{n} + h, \vec{Z}(x_{n}) + \vec{k}_{3}  \right)
		\end{aligned}
	\end{equation}
	kde finální tvar odhadu $\vec{Z}(x_{n+1})$ je
	\begin{equation}
		\vec{Z}(x_{n+1}) = \vec{Z}(x_{n}) + \frac{1}{6}  \left(\vec{k}_{1} +  2\vec{k}_{2} + 2\vec{k}_{3} + \vec{k}_{4} \right).
	\end{equation}
	Pro dopředný chod potřebujeme čtyři parametry v počátečním bodě a ty vezmeme jako
	\begin{equation}
		\vec{Z}(0) =
		\begin{pmatrix}
			z^{(0)}(0) \\
			z^{(1)}(0) \\
			z^{(2)}(0)
		\end{pmatrix},  \qq{přičemž} z^{(0)}(0) = z^{(1)}(0) = 0,
	\end{equation}
	tedy s našimi počátečními podmínkami hledáme v prostoru počátečních parametrů
	\begin{equation}
		\vec{Z}(0) \in \left(
		\begin{pmatrix}
			0 \\
			0 \\
			1 \\
		\end{pmatrix}
		\right)_{\lambda}.
	\end{equation}
	Koncový bod potom musí splňovat podmínku $z^{(1)}(10) = 1$, tedy koncové řešení je z prostoru
	\begin{equation}
		\vec{Z}(10) \in
		\begin{pmatrix}
			0 \\
			1 \\
			0 \\
		\end{pmatrix}  +
		\left(
		\begin{pmatrix}
			1 \\
			0 \\
			0 \\
		\end{pmatrix},
		\begin{pmatrix}
			0 \\
			0 \\
			1 \\
		\end{pmatrix}
		\right)_{\lambda}.
	\end{equation}
	K minimalizaci chyby splnění koncové podmínky, tedy hledání kořene funkce od $\vec{Z}$
	\begin{equation}
		B_{2}(x, \vec{Z}_{0}) \eval_{x = 10}= B_{2}(x, z^{(2)}_{0}) \eval_{x=0}= z^{(2)}(x) - 1 \eval_{x=10}= 0
	\end{equation}
	použijeme Newtonovou-Raphsonovou metodou. Přičemž pro vyhodnocení $z^{(2)}(10) - 1$ musíme vždy najít hodnotu $z^{(2)}(10)$ střelbou s proměnným počátečním parametrem $z^{(2)}_{0}$.

	\bigskip

	Protože máme prostor počátečních parametrů pouze jednodimenzionální, budeme k tomu potřebovat pouze parciální derivaci
	\begin{equation}
		\pdv{B_{2}}{z^{(2)}_{0}} \approx \frac{B_{2}(z^{(2)}_{0} + \Delta z^{(2)}_{0}) - B_{2}(z^{(2)}_{0})}{\Delta z^{(2)}_{0}}.
	\end{equation}
\end{example}
\end{document}
